var util = require("util");  
var utils = require('../../utils');
var events = require('events').EventEmitter;
var config = {};

function Controller(fns,config){
	events.call(this);
	this.config = config;
	this.data = {};
	var self = this;

	for(var i in fns){
		this[i] = function(req,res){
			self.__setup(req,res);
			fns[i].call(self);
		};
	}
	return this;
};


util.inherits(Controller,events);
utils.extend(Controller.prototype,require('./lib/proto'),true);


utils.extend(Controller,{
	create: function(fns){
		return new Controller(fns,config);
	},
	setApiPath: function(path){
		config.api = path;
	},
	setViewPath: function(path){
		config.view = path;
	},
	setViewEngine: function(engin){
		config.viewEngine = engin;
	}
},true);

module.exports = Controller;